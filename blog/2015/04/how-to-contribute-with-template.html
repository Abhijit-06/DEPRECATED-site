---
layout: blog
root: ../../..
author: Raniere Silva
title: "How to send pull request to lesson template"
date: 2015-04-04
time: "22:00:00"
category: ["How to"]
---
<!-- start excerpt -->
<p><a href="../../2014/09/splitting-the-repo.html">At the end of last year</a> we split out lessons to have one Git repository per topic that we teach. To ensure that all lessons have the same look we create <a href="https://github.com/swcarpentry/lesson-template/">one template for our lessons</a>. During the first quarter of this year we found that have two living branches at the same remote Git repository is confusing for many people and to address this we now have the core files of our template <a href="https://github.com/swcarpentry/lesson-template/pull/219">in one repository</a> and the example of how it looks at <a href="https://github.com/swcarpentry/lesson-example">another repository</a>. Because create a pull request to our lesson template could be not clear for someone starting with Git I wrote this how-to.</p>
<!-- end excerpt -->
<h2 id="setup">Setup</h2>
<p>I start cloning our example</p>
<pre><code>$ git clone -b gh-pages git@github.com:r-gaia-cs/lesson-example.git</code></pre>
<p>and add some remote repositories</p>
<pre><code>$ cd lesson-example
$ git remote add upstream git@github.com:swcarpentry/lesson-example.git
$ git remote add template git@github.com:r-gaia-cs/swc-lesson-template.git
$ git remote add template-upstream git@github.com:swcarpentry/lesson-template.git
$ git remote -v
origin  git@github.com:r-gaia-cs/swc-lesson-example.git (fetch)
origin  git@github.com:r-gaia-cs/swc-lesson-example.git (push)
template        git@github.com:r-gaia-cs/swc-lesson-template.git (fetch)
template        git@github.com:r-gaia-cs/swc-lesson-template.git (push)
template-upstream       git@github.com:swcarpentry/lesson-template.git (fetch)
template-upstream       git@github.com:swcarpentry/lesson-template.git (push)
upstream        git@github.com:swcarpentry/lesson-example.git (fetch)
upstream        git@github.com:swcarpentry/lesson-example.git (push)</code></pre>
<p>I use our example because it is easy to debug but if you want you use <code>origin</code> as your fork of the lessons you are working and <code>upstream</code> as the repository under Software Carpentry username that you are working is totally OK.</p>
<h2 id="preparation">Preparation</h2>
<p>Every time before I start to hack the template I update my local copy using</p>
<pre><code>$ git fetch origin
$ git fetch template
$ git fetch template-upstream
$ git fetch upstream
$ git checkout gh-pages
$ git merge upstream/gh-pages</code></pre>
<p>Once my local copy is updated I create a feature branch where I will work.</p>
<p>$ git checkout -b example-centering-image</p>
<h2 id="hacking">Hacking</h2>
<p>For this how to, suppose that I want to add the class <code>img-responsive</code> to every <code>img</code> elements of our lessons. One <strong>quickly and dirty</strong> way to do that is change <code>Makefile</code> with</p>
<pre><code>$ git diff 
diff --git a/Makefile b/Makefile
index 4d38850..ff49ca9 100644
--- a/Makefile
+++ b/Makefile
@@ -55,6 +55,7 @@ motivation.html : motivation.md _layouts/slides.revealjs Makefile
        --filter=tools/filters/id4glossary.py \
        $(INCLUDES) \
        -o $@ $&lt;
+       sed -i &#39;s/^&lt;img /&lt;img class=&quot;img-responsive&quot; /g&#39; $@

 # Pattern to convert R Markdown to Markdown.
 %.md: %.Rmd $(R_CHUNK_OPTS)</code></pre>
<p>To avoid lose my work I save it at the staged area:</p>
<pre><code>$ git add -u</code></pre>
<p>Now I compile the HTML files:</p>
<pre><code>$ make -B preview</code></pre>
<p>And verify the changes.</p>
<pre><code>$ git diff
diff --git a/01-one.html b/01-one.html
index 7622e55..1fc0d45 100644
--- a/01-one.html
+++ b/01-one.html
@@ -56,7 +56,8 @@ program&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;
 &lt;p&gt;or an image from the &lt;code&gt;figs&lt;/code&gt; directory:&lt;/p&gt;
 &lt;div class=&quot;figure&quot;&gt;
-&lt;img src=&quot;fig/example.svg&quot; title=&quot;this is the image&amp;#39;s alt text&quot; alt=&quot;this is the image&amp;#39;s title&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;this is the image&#39;s title&lt;/p&gt;
+&lt;img class=&quot;img-responsive&quot; src=&quot;fig/example.svg&quot; title=&quot;this is the image&amp;#39;s alt text&quot; alt=&quot;this is the image&amp;#39;s title&quot; /&gt;
+&lt;p class=&quot;caption&quot;&gt;this is the image&#39;s title&lt;/p&gt;
 &lt;/div&gt;
 &lt;div id=&quot;challenge-title&quot; class=&quot;challenge panel panel-success&quot;&gt;
 &lt;div class=&quot;panel-heading&quot;&gt;</code></pre>
<p>This is exactly what I want. Great!!! I can now commit my changes.</p>
<pre><code>$ git commit -m &#39;Add img-responsive class to img&#39;
[example-centering-image a9cc86d] Add img-responsive class to img
 1 file changed, 1 insertion(+)</code></pre>
<p>I will also save the change at the HTML file.</p>
<pre><code>$ git add -u
$ git commit -m &#39;Update HTML&#39;
[example-centering-image 1ebf8c3] Update HTML
 1 file changed, 2 insertions(+), 1 deletion(-)</code></pre>
<h2 id="copying-the-change-to-template">Copying the change to template</h2>
<p>If you attend a Software Carpentry workshop you should be confortable with what you see until now. What I need to do is copy my change at <code>Makefile</code> to <a href="https://github.com/swcarpentry/lesson-template">template</a> using <code>git cherry-pick</code>. If you are trying to remember it from our workshop, don't panic because we don't teach it but you will discovery that it is very simple to use.</p>
<p>Before anything else I need to know the ID of the commit I want to copy, the one where I changed <code>Makefile</code>.</p>
<pre><code>$ git log --oneline -3
1ebf8c3 Update HTML
a9cc86d Add img-responsive class to img
5426365 Merge pull request #1 from gvwilson/updating-docs</code></pre>
<p>The commit that I want is <code>a9cc86d</code>. I will save the ID for a moment until I create a new branch starting from the template (<strong>instead of the example</strong>):</p>
<pre><code>$ git checkout template-upstream/gh-pages
$ git checkout -b template-centering-image</code></pre>
<p>Now I can &quot;copy and paste&quot; my change, using the commit ID, and for that I use</p>
<pre><code>$ git cherry-pick a9cc86d
[template-centering-image 2004c4f] Add img-responsive class to img
 Date: Sat Apr 4 18:19:26 2015 -0300
 1 file changed, 1 insertion(+)</code></pre>
<p>I can check that the commit was copied</p>
<pre><code>$ git log --oneline -2
2004c4f Add img-responsive class to img
cf25427 Merge pull request #218 from wking/trailing-newlines</code></pre>
<p>The commit ID change but this is OK and is desired. Now I can upload my changes</p>
<pre><code>$ git push origin example-centering-image
$ git push template template-centering-image</code></pre>
<p>And <a href="https://github.com/swcarpentry/lesson-template">create a pull request</a>, <a href="https://github.com/swcarpentry/lesson-template/pull/219">like this one</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Once the pull request was created our contributors <a href="https://github.com/swcarpentry/lesson-template/pull/219#issuecomment-89671094">will review it</a> and eventually merge it. From time to time we will propagate the change at our template to our lessons.</p>
<p>If your changes are at the CSS that we use you <strong>must</strong> copy our changes to <a href="https://github.com/swcarpentry/styles/">this repository</a> instead of <code>template</code>.</p>
<p>As always, in case of troubles with Git you can contact us and one of your Git gurus will get back to you for help.</p>
<p>P.S.: I take this opportunity to thanks for the help of <a href="https://github.com/fmichonneau">Francois Michonneau</a>, <a href="https://github.com/jpallen">James Allen</a> and <a href="https://github.com/pbanaszkiewicz">Piotr Banaszkiewicz</a> to improve our CSS.</p>
